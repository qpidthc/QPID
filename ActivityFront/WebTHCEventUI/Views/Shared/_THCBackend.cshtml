
@{
    Layout = null;
}

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewBag.Title </title>
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/bc/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="~/bc/css/nice-select.css">
    <link rel="stylesheet" href="~/bc/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="~/bc/css/dataTables.jqueryui.min.css">
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.3/themes/redmond/jquery-ui.css">
    <link rel="stylesheet" href="~/bc/css/side-bar.css">
    <link rel="stylesheet" href="~/bc/css/datatable.css">
    <link rel="stylesheet" href="~/bc/css/bootstrap-toggle.min.css">

    <script src="~/bc/js/jquery-2.1.1.min.js"></script>
    <script src="~/bc/js/bootstrap.min.js"></script>
    <script src="~/bc/js/validator.min.js"></script>
    <script src="~/bc/js/jquery.nice-select.min.js"></script>
    <script src="~/bc/js/bootstrap-select.min.js"></script>
    <script src="~/bc/js/bootstrap-datepicker.min.js"></script>
    <script src="~/bc/js/bootstrap-datepicker.zh-TW.min.js" charset="UTF-8"></script>
    <script src="~/bc/js/jquery.dataTables.min.js"></script>
    <script src="~/bc/js/dataTables.jqueryui.min.js"></script>
    <script src="~/bc/js/bootstrap-toggle.min.js"></script>

    <style>
        .modal-header-success {
            color: #fff;
            padding: 9px 15px;
            border-bottom: 1px solid #eee;
            background-color: #5cb85c;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .modal-header-warning {
            color: #fff;
            padding: 9px 15px;
            border-bottom: 1px solid #eee;
            background-color: #f0ad4e;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .modal-header-danger {
            color: #fff;
            padding: 9px 15px;
            border-bottom: 1px solid #eee;
            background-color: #d9534f;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .modal-header-info {
            color: #fff;
            padding: 9px 15px;
            border-bottom: 1px solid #eee;
            background-color: #5bc0de;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .modal-header-primary {
            color: #fff;
            padding: 9px 15px;
            border-bottom: 1px solid #eee;
            background-color: #428bca;
            -webkit-border-top-left-radius: 5px;
            -webkit-border-top-right-radius: 5px;
            -moz-border-radius-topleft: 5px;
            -moz-border-radius-topright: 5px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

.navbar-default {
  font-size: 1.15em;
  font-weight: 400;
  background-color: #006b96;
  padding: 10px;
  border: 0px;
  border-radius: 0px;
}

.navbar-default .navbar-nav>li>a {
  color: white;
}

.navbar-default .navbar-nav>li>a:hover {
  color: #cbf0ff;
}

.navbar-default .navbar-brand {
  color: #ffffff;
}

.navbar-default .navbar-brand:hover {
  color: #ffffff;
  text-shadow: 1px -1px 8px #b3e9ff;
}

.navbar-default .navbar-nav>.open>a, .navbar-default .navbar-nav>.open>a:hover, .navbar-default .navbar-nav>.open>a:focus {
  background-color: #004059;
  color: white;
}

.navbar-default .navbar-toggle {
  border: none;
}

.navbar-default .navbar-collapse, .navbar-default .navbar-form {
  border: none;
}

.navbar-default .navbar-toggle:hover, .navbar-default .navbar-toggle:focus {
  background-color: #002433;
}

.navbar-default .navbar-toggle .icon-bar {
  background-color: #ffffff;
}

.dropdown-menu {
  background-color: #004059;
  color: white;
  border: 0px;
  border-radius: 2px;
  padding-top: 10px;
  padding-bottom: 10px;
}

        .dropdown-menu>li>a {
          background-color: #004059;
          color: #ffffff;
        }

            .dropdown-menu > li > a:hover {
                background-color: #004059;
                color: #fcb200;
            }

        .dropdown-menu .alink :hover {
            background-color: #004059;
            color: #fcb200 !important;
        }

        .dropdown-menu .divider {
            height: 1px;
            margin: 9px 0;
            overflow: hidden;
            background-color: #ffffff;
        }

.navbar-default .navbar-nav .open .dropdown-menu>li>a {
    color: #ffffff;
}

@@media (max-width: 767px) {
        .dropdown-menu>li>a {
        background-color: #006b96;
        color: #ffffff;
        }

        .dropdown-menu>li>a:hover {
        color: #d9534f;
        }

        .navbar-default .navbar-nav .open .dropdown-menu>li>a:focus, .navbar-default .navbar-nav .open  {
        color: #ffffff;
        background-color: transparent;
        }

        .dropdown-menu .divider {
            height: 1px;
            margin: 9px 0;
            overflow: hidden;
            background-color: #ffffff;
        }
} 
    </style>
</head>

<body>
    <!-- Sidebar -->
    <nav id="menu" class="left">
        <ul>
            <li>
                <a href="#"><i class="fa fa-gears"></i>活動事件管理 <i class="fa fa-caret-down"></i></a>
                <ul>
                    <li><a href="@Url.Content("~/")Backend/EventActivities" tog>&nbsp;&nbsp;&nbsp;&nbsp;行銷活動資料</a></li>
                    <li><a href="@Url.Content("~/")Backend/EventRewards" tog>&nbsp;&nbsp;&nbsp;&nbsp;活動獎項資料</a></li>
                </ul>
            </li>
            <!--
            <li><a href="#"><i class="fa fa-info-circle"></i>About</a></li>
            -->
            <li>
                <a href="#"><i class="fa fa-barcode"></i>碼號管理 <i class="fa fa-caret-down"></i></a>
                <ul>
                    <li><a href="@Url.Content("~/")Backend/RewardEarn" tog>&nbsp;&nbsp;&nbsp;&nbsp;中獎資料查詢與匯出</a></li>                    
                </ul>
            </li>
            <li>
                <a href="#"><i class="fa fa-search"></i>資料分析 <i class="fa fa-caret-down"></i></a>
                <ul>
                    <li><a href="@Url.Content("~/")Backend/DataAnalysis" tog>&nbsp;&nbsp;&nbsp;&nbsp;活動統計資料</a></li>  
                    <li><a href="@Url.Content("~/")Backend/DataDashboard" tog>&nbsp;&nbsp;&nbsp;&nbsp;活動 Dashboard</a></li> 
                </ul>
            </li>
            @{
                if (@ViewBag.ADMIN != null)
                {
                    if (ViewBag.ADMIN)
                    {
                        <li>
                            <a href="#"><i class="fa fa-laptop"></i>系統管理 <i class="fa fa-caret-down"></i></a>
                            <ul>
                                <li><a href="@Url.Content("~/")control/UserControl" tog>&nbsp;&nbsp;&nbsp;&nbsp;系統使用者管理</a></li>
                                <li><a href="@Url.Content("~/")control/ImportActivity" tog>&nbsp;&nbsp;&nbsp;&nbsp;活動建置</a></li>
                            </ul>
                        </li>
                    }
                }
             }

        </ul>
        <p href="#" id="showmenu" style=" font-size: 2.0em;"> <i class="fa fa-align-justify"></i> </p>
    </nav>
    <!-- Sidebar End -->

    <div id="wrapper">
        <div class="overlay"></div>

        <!-- Page Content -->
        <div id="page-content-wrapper">

            <!-- nav bar -->
            <nav class="navbar navbar-default navbar-fixed-top">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="#" style="margin-left:0px;">活動事件控制台</a>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                  
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <!-- 
                        <ul class="nav navbar-nav">
                            <li><a href="#"><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Dashboard</a></li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Tasks <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="#"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> &nbsp; &nbsp; Overview</a></li>
                                    <li class="alink"><a href="#"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> &nbsp; &nbsp; New Task</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="#"> &nbsp; &nbsp; Categories</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Contacts <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="#">Übersicht</a></li>
                                    <li class="alink"><a href="#">New Contact</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="#">Categories</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Notes <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="#">Overview</a></li>
                                    <li class="alink"><a href="#">New Notiz</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="#">Notebooks</a></li>
                                </ul>
                            </li>
                            <li><a href="#">Accounts</a></li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Learnings <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="#">Overview</a></li>
                                    <li class="alink"><a href="#">New Learning</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="#">Categories</a></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Log <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="#">Overview</a></li>
                                    <li class="alink"><a href="#">New Entry</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="#">Topics</a></li>
                                </ul>
                            </li>
                        </ul>
                    -->
                        <ul class="nav navbar-nav navbar-right">
                            <!-- 
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Links<span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li class="alink"><a href="http://www.google.ch" target="_blank">My Webmail</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li class="alink"><a href="http://www.google.ch" target="_blank">Timelogger</a></li>
                                    <li class="alink"><a href="http://www.cubetech.ch" target="_blank">cubetech.ch</a></li>
                                </ul>
                            </li>
                            -->
                            <li class="dropdown">
                                <a href="return javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                                    <span id="a_account"></span>
                                    <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <!-- 
                                        <li class="alink"><a href="http://www.fgruber.ch/" target="_blank"><span class="glyphicon glyphicon-cog" aria-hidden="true"></span> User Settings</a></li>
                                    -->
                                    <li class="alink"><a href="javascript:void(0);" onclick="changeAccessCode()"><span class="glyphicon glyphicon-cog" aria-hidden="true"></span> 變更密碼</a></li>
                                    <li class="alink"><a href="javascript:void(0);" onclick="logOut();" ><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> 登出</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><!-- /.navbar-collapse -->
                   

                </div><!-- /.container-fluid -->
            </nav>
            <!-- nav bar end -->
            @RenderBody()

        </div>
        <!-- Page Content End-->
    </div>

    <!-- Modal -->
    <div id="qModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div id="mdl_header" class="modal-header modal-header-info">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 id="mdl_title" class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body" style="word-break: break-all;">
                    <p id="mdl_message" style="font-size:20px;"> Some text in the modal.</p>
                </div>
                <div class="modal-footer">
                    <button id="btn_OK" type="button" class="btn btn-primary" data-dismiss="modal" onclick="onModalOK();">&nbsp;&nbsp;OK&nbsp;&nbsp;</button>
                    <button id="btn_Yes" type="button" class="btn btn-danger" data-dismiss="modal" onclick="onMoadlYes();">&nbsp;&nbsp;Yes&nbsp;&nbsp;</button>
                    <button id="btn_No" type="button" class="btn btn-default" data-dismiss="modal" onclick="onModalNo();">&nbsp;&nbsp;No&nbsp;&nbsp;</button>
                </div>
            </div>

        </div>
    </div>

    @*
        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")
    *@

    @RenderSection("scripts", required: false)

    <script>

    var modalHanlder;
    var actionCode;
    var autoHide;
    var pedding = false;
    var editMode; /*A,U,''*/

    $("#showmenu").click(function (e) {

        e.preventDefault();
        overlay = $('.overlay');
        $("#menu").toggleClass("show");

        if ($("#menu").hasClass("show")) {
            $('#menu').css("boxShadow", "10px 0px 40px #2F2F2F");
            overlay.show();
            $("#showmenu").hide();
        } else {
            $('#menu').css("boxShadow", "0px 0px 0px #2F2F2F");
            overlay.hide();
        }

        //if ($('#menu').hasClass("boxShadow")) {
        //    $('#menu').removeClass("boxShadow");
        // } else {
        //     $('#menu').css("boxShadow", "10px 0px 40px #888888");
        // }
    });

    $("#menu a").click(function (event) {

        //alert($(this).text());
        var attr = $(this).attr('TOG');

        if (typeof attr !== typeof undefined && attr !== false) {

        } else {
            event.preventDefault();
            if ($(this).next('ul').length) {
                $(this).next().toggle('fast');
                $(this).children('i:last-child').toggleClass('fa-caret-down fa-caret-left');
            }
        }
    });

    $(document).ready(function () {

        $('[data-toggle="offcanvas"]').click(function () {
            $('#wrapper').toggleClass('toggled');
        });

        $(".overlay").bind("click", function () {

            //overlay = $('.overlay');
            //$('#wrapper').toggleClass('toggled');
            $("#menu").toggleClass("show");
            $('#menu').css("boxShadow", "0px 0px 0px #2F2F2F");
            $(this).hide();
            $("#showmenu").show();
        });


        $("#a_account").text('@ViewBag.ACCOUNT');
    });

    function onLanguageChanged(lan) {

        @*var data = { "lan": lan };
            $.ajax({
                async: false,
                type: "POST",
                url: '@Url.Content("~/")system/SetLanguage',
                data: data,
                dataType: 'json',
                success: function (data, status, xhr) {

                    jDatas = jQuery.parseJSON(data);
                    if (jDatas.length == 1) {
                        window.location.reload();
                    } else {
                        if (jDatas.ErrorMessage) {
                            showQMoal('e', false, jDatas.ErrorMessage, 0, null);
                        }
                    }
                },
                error: function (request, error) {
                    alert(error + " : " + request.responseText);
                },
                complete: function () {
                    hideLoadingBar();
                }
            });*@

    }

    function onModalOK() {

        if (modalHanlder != null) {
            //|| typeof(modalHanlder) != "undefined") {
            modalHanlder(actionCode);
        }
        autoHide = true;
        $("#qModal").modal('hide');
    }

    function onMoadlYes() {
        if (modalHanlder != null) {
            modalHanlder(actionCode, 'y');
        }
        if (pedding) {
            pedding = false;
            //autoHide = true;
            //$("#qModal").modal('hide');
        } else {
            autoHide = true;
            $("#qModal").modal('hide');
        }

    }

    function onModalNo() {
        if (modalHanlder != null) {
            modalHanlder(actionCode, 'n');
        }
        autoHide = true;
        $("#qModal").modal('hide');
    }

    function peddingHide() {
        pedding = true;
    }

    function showQMoal(type, autohide, msg, action, handler) {

        $("#mdl_header").removeClass('modal-header-success');
        $("#mdl_header").removeClass('modal-header-warning');
        $("#mdl_header").removeClass('modal-header-danger');
        $("#mdl_header").removeClass('modal-header-info');
        $("#mdl_header").removeClass('modal-header-primary');

        actionCode = action;
        modalHanlder = handler;
        autoHide = autohide;

        $("#btn_OK").hide();
        $("#btn_Yes").hide();
        $("#btn_No").hide();

        if (type == 'q') {
            $("#mdl_header").addClass('modal-header-primary');
            $("#btn_Yes").show();
            $("#btn_No").show();
            $("#mdl_title").text('詢問視窗');
        } else if (type == 'i') {
            $("#mdl_header").addClass('modal-header-info');
            $("#btn_OK").show();
            $("#mdl_title").text('通知視窗');
        } else if (type == 'e') {
            $("#mdl_header").addClass('modal-header-danger');
            $("#btn_OK").show();
            $("#mdl_title").text('錯誤視窗');
        } else if (type == 'w') {
            $("#mdl_header").addClass('modal-header-warning');
            $("#btn_OK").show();
            $("#mdl_title").text('警告視窗');
        }

        $("#mdl_message").text(msg);

        $("#qModal").modal('show');
    }

    jQuery('#qModal').on('hide.bs.modal', function () {

        return autoHide;
    });

    function showLoadingBar() {
        $("#img_bar").show();
    }

    function hideLoadingBar() {
        $("#img_bar").hide();
    }

    function logOut() {

        $formData = "user=" + $("#a_account").val();

        $.ajax({
            async: false,
            type: "POST",
            url: '@Url.Content("~/")Control/Logout',
            data: $formData,
            dataType: 'json',
            success: function (data, status, xhr) {

                jDatas = jQuery.parseJSON(data);
                if (jDatas.ErrorMessage) {
                    showQMoal('e', false, jDatas.ErrorMessage, 0, null);
                } else {
                    window.location.href = "@Url.Content("~/")Control/";
                    }
                },
                error: function (request, error) {
                    alert(error + " : " + request.responseText);

                },
                complete: function () {
                    hideLoadingBar();
                }
            });
        }

        function changeAccessCode() {
            window.location.href = '@Url.Content("~/")Control/ModifyAccessCode';
        }


    </script>

</body>
</html>

